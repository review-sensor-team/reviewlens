# Prometheus 설정 파일
global:
  scrape_interval: 10s      # 15초마다 메트릭 수집
  evaluation_interval: 10s  # 15초마다 규칙 평가
  external_labels:
    cluster: 'reviewlens'
    environment: 'development'

# Alertmanager 설정 (선택사항)
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets:
#           - alertmanager:9093

# 스크랩 대상 설정
scrape_configs:
  # FastAPI 애플리케이션 메트릭
  - job_name: 'reviewlens-api'
    scrape_interval: 10s
    metrics_path: '/metrics'
    static_configs:
      # Docker 컨테이너 내부에서 Windows 호스트 접근
      - targets: ['host.docker.internal:8000']
        labels:
          service: 'reviewlens-api'
          component: 'backend'

  # Prometheus 자체 메트릭
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # 크롤링 스크립트 메트릭 (--metrics-port 옵션 사용 시)
  # 주의: 스크립트 실행 시 --metrics-port 8001 옵션 필요
  - job_name: 'crawl-script'
    scrape_interval: 30s
    static_configs:
      - targets: ['host.docker.internal:8001']
        labels:
          service: 'crawl-script'
          component: 'crawler'